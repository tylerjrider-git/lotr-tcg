<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOTR TCG Prototype</title>

    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <h1 id="loginGreeting">Welcome to the TestApp </h1>
    <input id="msg" type="text" placeholder="Enter a Card ID">
    <button onclick="sendMessage()"> Add Card To Deck</button>
    <h2>GameId:</h2>
    <ul id="gameId">"-"</ul>

    <script>
        window.onload = function () {
            const playerInfo = localStorage.getItem("playerName");
            const gameId = localStorage.getItem("gameID");
            const heading = document.getElementById("loginGreeting");
            if (playerInfo) {
                heading.innerText = "Welcome to the LOTR TCG " + playerInfo;
            }
            const gameIdHeading = document.getElementById("gameId")
            gameIdHeading.innerText = gameId

        };
    </script>

    <!-- <input id="playerInfo" type="text" placeholder="What is your player name?">
    <button onclick="updatePlayerInfo()"> Send</button>
    <script>
        function updatePlayerInfo() {
            const info = document.getElementById('playerInfo').value;
            console.log("Player entered information ok");
            socket.emit('playerInfoUpdated', info);
            localStorage.setItem("playerInfo", info);
        }
    </script> -->

    <h1></h1>
    <canvas id="gameCanvas" width="7680" height="4320"></canvas>
    <script src="canvas.js"></script>

    <!-- This sends data back to my server. -->
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        socket.on('messageAck', (data) => {
            const li = document.createElement('li');
            li.textContent = data;
            document.getElementById('serverLog').appendChild(li);
        });

        function sendMessage() {
            const msg = document.getElementById('msg').value;
            socket.emit('message', msg);

            console.log("Sending message across document")
            document.dispatchEvent(new CustomEvent("cardAdded", { detail: msg }));
        }

        document.addEventListener('cardEvent', (msg) => {
            console.log("Got a card Movement Event message: %s", msg.detail)
            const li = document.createElement('li');
            li.textContent = msg.detail;
            document.getElementById('serverLog').appendChild(li);
            socket.emit('cardEvent', msg.detail)
        })

        socket.on('cardEventAck', (msg) => {
            console.log("cardEventAck");

        })

    </script>

    <h2>ServerLog:</h2>
    <ul id="serverLog"></ul>

</body>

</html>
